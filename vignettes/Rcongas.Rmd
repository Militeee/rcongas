---
title: "Rcongas"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Rcongas}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r, warning=FALSE, message=FALSE}
library(Rcongas)
library(dplyr)
```

# Single-molecule assay

```{r}
data('example_input')

# Example only RNA, with z-score representation (Gaussian likelihood)
x = init(
  rna = example_input$x_rna,
  atac = NULL,
  segmentation = example_input$x_segmentation,
  normalisation_factors = example_input$x_normalisation_factors,
  rna_likelihood = "G", 
  atac_likelihood = 'NB',
  description = 'My crazy model')

print(x)
```

```{r, fig.width=6, fig.height=6}
# Select the first 5 segments to plot
some_segments = get_input(x, what = "segmentation") %>% 
  filter(row_number() < 5) %>% 
  pull(segment_id)

plot_data(x, what = 'histogram', segments = some_segments)
```

```{r, fig.width=8, fig.height=4}
plot_data(x, what = 'lineplot')
```

```{r, fig.width=6, fig.height=6}
plot_data(x, what = 'heatmap')
```


# Two single-molecule assays

```{r}
# Joint RNA (as above), and ATAC (discrete count, Negative Binomial likelihood)
x = init(
  rna = example_input$x_rna,
  atac = example_input$x_atac,
  segmentation = example_input$x_segmentation,
  normalisation_factors = example_input$x_normalisation_factors,
  rna_likelihood = "G", 
  atac_likelihood = 'NB',
  description = 'My crazy model')
```

```{r, fig.width=6, fig.height=6}
plot_data(x, what = 'histogram', segments = some_segments)
```

```{r, fig.width=8, fig.height=4}
plot_data(x, what = 'lineplot')
```

```{r, fig.width=6, fig.height=8}
plot_data(x, what = 'heatmap')
```
