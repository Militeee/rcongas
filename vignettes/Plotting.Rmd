---
title: "Plotting functions"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Plotting functions}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r, warning=FALSE, message=FALSE}
library(Rcongas)
library(dplyr)
```


```{r}
data('example_object')

print(example_object)
```

# Data plots

## General logic

The main plotting function for data is `plot_data`; this function calls a number of internal
other plotting function, depending on its `what` parameter. Each one of the internal functions
can take one or more parameters, most of them with defaults; parameters to these functions can
be passed through the ellipssis `...` argument of `plot_data`.

These are the internal functions and their named parameters

```{r}
formals(Rcongas:::plot_data_histogram) %>% names()
formals(Rcongas:::plot_data_lineplot) %>% names()
formals(Rcongas:::plot_data_heatmap) %>% names()
formals(Rcongas:::plot_data_mapping) %>% names()
```

> For instance: calling `plot_data(x, what = "lineplot")` will call `Rcongas:::plot_data_lineplot`. So in that case you can change the default plotting behaviour using the parameters matching the formal arguments.



## Data histogram plots

This shows input values per modality, split by segments, as histogram.

```{r, fig.width=13, fig.height=13}
plot_data(example_object, what = 'histogram')
```

**Custom calling:** the internal arguments are as follows (by default, all segments are plot)

```{r}
formals(Rcongas:::plot_data_histogram)
```

So you can subset the function to plot, say, the first 3 segments in the data

```{r, fig.width=4, fig.height=5}
which_segments = get_input(example_object, what = 'segmentation') %>% 
  filter(row_number() <= 3) %>% 
  pull(segment_id)

# Pass formal "segments"
plot_data(example_object, what = 'histogram', segments = which_segments)
```

## Data genome-wide lineplot

This function plot a per-segment line for every cell in the dataset, showing
all modalities and the input segmentation

```{r, fig.width=8, fig.height=4}
plot_data(example_object, what = 'lineplot')
```

**Custom calling:** the internal arguments are as follows (by default, all segments are plot with no transparency)

```{r}
formals(Rcongas:::plot_data_lineplot)
```

So you can add transparency to see where the mass of values concentrates.

```{r, fig.width=8, fig.height=4}
# Pass formal "alpha"
plot_data(example_object, what = 'lineplot', alpha = 0.3)
```

## Data heatmap

This function shows a view per cell, per segment, of the input values. This plot
can be very large depending on the number of cells in the data

```{r, fig.width=6, fig.height=8}
plot_data(example_object, what = 'heatmap')
```

**Custom calling:** the internal arguments are as follows (by default, all segments are plot)

```{r}
formals(Rcongas:::plot_data_histogram)
```

So you can subset the function to plot a custom set of segments (as above)

```{r, fig.width=3, fig.height=8}
# Pass formal "segments"
plot_data(example_object, what = 'heatmap', segments = which_segments)
```

## Data mapping

This function plots the number of input events mapped to each segment. These
are genes for the RNA modality, and peaks for the ATAC modality.


```{r, fig.width=6, fig.height=6}
plot_data(example_object, what = 'mapping')
```

**Custom calling:** this function has no internal arguments.