<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Filter per-segment outliers by quantiles. — filter_missing_data • Rcongas</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Filter per-segment outliers by quantiles. — filter_missing_data" />
<meta property="og:description" content="After mapping counts data to segments, this function
can be used to determine quantiles of mapped data, and identify
outliers in each segment and modality.
An outlier can then be removed or capped to the median cell value.
The former option introduced 0-counts in the data, which we suggest
to check with the stat function, and possibly remove by using
the filter_missing_data function. Removal can be important as
an excess of 0-counts cells (missing data) will drive the fit
to use 0-mean components.
Capping does not introduce any 0-count cell, and is the suggested choice.
The capped values is either a count value or a z-score, depending on
the modality type of likelihood.
In both cases pre-filtering normalisation factors are no longer adequate
after filtering, and have to be recomputed. If the modality adopts a
Gaussian likelihood this is not a problem, since those are set to 1
when the object is created, and remain 1 afterwards. In the case of counts
based likelihood like Negative Binomials these are re-computed for all
input cells by using the auto_normalisation_factor function.
Therefore, if custom factors have been computing this function might
affect the general signal in the data, and factors should be handled
explicitly by the user.
The function requires and returns an (R)CONGAS+ object.
After mapping counts data to segments, this function
can be used to determine cells with missing data, and remove
them The function requires and returns an (R)CONGAS+ object.
This filter works by a proportion, as reported by the stat function.
If these cells are not removed, during inference missing values
are imputed to be 0. This can create an excess of mixture components
fitting 0-counts data." />
<meta property="og:image" content="caravagnalab.github.io/Rcongas/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Rcongas</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/Rcongas.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/Filtering.html">Filtering functions</a>
    </li>
    <li>
      <a href="../articles/Fitting.html">Fitting a model</a>
    </li>
    <li>
      <a href="../articles/Plotting.html">Plotting functions</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/caravagnalab/Rcongas/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Filter per-segment outliers by quantiles.</h1>
    <small class="dont-index">Source: <a href='https://github.com/caravagnalab/RcongasR/filter_mapped.R'><code>R/filter_mapped.R</code></a></small>
    <div class="hidden name"><code>filter_missing_data.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>After mapping counts data to segments, this function
can be used to determine quantiles of mapped data, and identify
outliers in each segment and modality.</p>
<p>An outlier can then be removed or capped to the median cell value.
The former option introduced 0-counts in the data, which we suggest
to check with the <code>stat</code> function, and possibly remove by using
the <code>filter_missing_data</code> function. Removal can be important as
an excess of 0-counts cells (<em>missing data</em>) will drive the fit
to use 0-mean components.</p>
<p>Capping does not introduce any 0-count cell, and is the suggested choice.
The capped values is either a count value or a z-score, depending on
the modality type of likelihood.</p>
<p>In both cases pre-filtering normalisation factors are no longer adequate
after filtering, and have to be recomputed. If the modality adopts a
Gaussian likelihood this is not a problem, since those are set to 1
when the object is created, and remain 1 afterwards. In the case of counts
based likelihood like Negative Binomials these are re-computed for all
input cells by using the <code>auto_normalisation_factor</code> function.</p>
<p>Therefore, if custom factors have been computing this function might
affect the general signal in the data, and factors should be handled
explicitly by the user.</p>
<p>The function requires and returns an (R)CONGAS+ object.</p>
<p>After mapping counts data to segments, this function
can be used to determine cells with missing data, and remove
them The function requires and returns an (R)CONGAS+ object.</p>
<p>This filter works by a proportion, as reported by the <code><a href='stat.html'>stat</a></code> function.</p>
<p>If these cells are not removed, during inference missing values
are imputed to be <code>0</code>. This can create an excess of mixture components
fitting 0-counts data.</p>
    </div>

    <pre class="usage"><span class='fu'>filter_missing_data</span><span class='op'>(</span><span class='va'>x</span>, proportion_RNA <span class='op'>=</span> <span class='fl'>0.05</span>, proportion_ATAC <span class='op'>=</span> <span class='fl'>0.05</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>An <code>rcongasplus</code> object.</p></td>
    </tr>
    <tr>
      <th>proportion_RNA</th>
      <td><p>The RNA proportion cut for a cell to be removed, default 5%.</p></td>
    </tr>
    <tr>
      <th>proportion_ATAC</th>
      <td><p>The ATAC proportion cut for a cell to be removed, default 5%.</p></td>
    </tr>
    <tr>
      <th>lower_quantile</th>
      <td><p>The lower quantile, default 1%.</p></td>
    </tr>
    <tr>
      <th>upper_quantile</th>
      <td><p>The upper quantile, default 99%.</p></td>
    </tr>
    <tr>
      <th>action</th>
      <td><p>If <code>"remove"</code>, outliers will be set to 0. If <code>"cap"</code>,
outliers will be capped at the median per-cell counts.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>The object <code>x</code> where outliers have been identified and removec
or capped according to the parameters.</p>
<p>The object <code>x</code> where 0-counts cells have been removed.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by <a href='https://www.caravagnalab.org'>Salvatore Milite</a>, <a href='https://www.caravagnalab.org'>Riccardo Bergamin</a>, <a href='https://www.caravagnalab.org'>Giulio Caravagna</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


