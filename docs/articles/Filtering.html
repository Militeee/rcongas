<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Filtering functions • Rcongas</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Filtering functions">
<meta property="og:description" content="Rcongas">
<meta property="og:image" content="caravagnalab.github.io/Rcongas/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Rcongas</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/Rcongas.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Filtering.html">Filtering functions</a>
    </li>
    <li>
      <a href="../articles/Plotting.html">Plotting functions</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/caravagnalab/Rcongas/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="Filtering_files/header-attrs-2.7/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Filtering functions</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/caravagnalab/Rcongasvignettes/Filtering.Rmd"><code>vignettes/Filtering.Rmd</code></a></small>
      <div class="hidden name"><code>Filtering.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">Rcongas</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span></code></pre></div>
<!-- ```{r, eval=T} -->
<!-- data('example_object') -->
<!-- print(example_object) -->
<!-- ``` -->
<p>Filtering functions are available for data to ba analysed before or after it is loaded into the package.</p>
<ul>
<li><p><strong>Before loading:</strong> pre-process data that is ready for usage in the tool, returning an equivalent tibble with fewer rows;</p></li>
<li><p><strong>After loading</strong> process data that has already being inputed to the tool, returning a new  object.</p></li>
</ul>
<div id="filtering-count-data" class="section level2">
<h2 class="hasAnchor">
<a href="#filtering-count-data" class="anchor"></a>Filtering count data</h2>
<div id="known-genes" class="section level3">
<h3 class="hasAnchor">
<a href="#known-genes" class="anchor"></a>Known genes</h3>
<p>We have observed high variability across ribosomal (<code>r</code>) and mitochondrial (<code>m</code>) genes, which confounds signals in the data,</p>
<p>We usually remove these genes, using function <code>filter_known_genes</code>. This function takes in input a <code>what</code> parameter (default <code>mr</code>) which determines what genes should be removed, plus an extra <code>specials</code> list of Hugo Symbols to remove.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># The default value for `specials`</span>
<span class="fu"><a href="https://rdrr.io/r/base/formals.html">formals</a></span><span class="op">(</span><span class="va">filter_known_genes</span><span class="op">)</span><span class="op">$</span><span class="va">specials</span>
<span class="co">#&gt; [1] "MALAT1"</span></code></pre></div>
<p>Mitochondrial and ribosomal genes are identified by name using regular expression <code>"MT"</code> or <code>"RP[SL]"</code>, respectively.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">'example_input'</span><span class="op">)</span>
<span class="va">example_input</span><span class="op">$</span><span class="va">rna</span> <span class="op">%&gt;%</span> <span class="va">print</span>
<span class="co">#&gt; # A tibble: 201,459 x 6</span>
<span class="co">#&gt;    gene     chr      from      to cell                                 value</span>
<span class="co">#&gt;    &lt;chr&gt;    &lt;chr&gt;   &lt;int&gt;   &lt;int&gt; &lt;chr&gt;                                &lt;int&gt;</span>
<span class="co">#&gt;  1 NOC2L    chr1   944203  959309 bcc.su008.pre.tumor_AAGGCAGTCACCGTAA     2</span>
<span class="co">#&gt;  2 AGRN     chr1  1020120 1056118 bcc.su008.pre.tumor_AAGGCAGTCACCGTAA     1</span>
<span class="co">#&gt;  3 SDF4     chr1  1216909 1232067 bcc.su008.pre.tumor_AAGGCAGTCACCGTAA     1</span>
<span class="co">#&gt;  4 ACAP3    chr1  1292390 1309609 bcc.su008.pre.tumor_AAGGCAGTCACCGTAA     2</span>
<span class="co">#&gt;  5 CPTP     chr1  1324756 1328896 bcc.su008.pre.tumor_AAGGCAGTCACCGTAA     1</span>
<span class="co">#&gt;  6 AURKAIP1 chr1  1373730 1375495 bcc.su008.pre.tumor_AAGGCAGTCACCGTAA     1</span>
<span class="co">#&gt;  7 CCNL2    chr1  1385711 1399335 bcc.su008.pre.tumor_AAGGCAGTCACCGTAA     2</span>
<span class="co">#&gt;  8 MRPL20   chr1  1401909 1407293 bcc.su008.pre.tumor_AAGGCAGTCACCGTAA     1</span>
<span class="co">#&gt;  9 CDK11B   chr1  1635225 1659012 bcc.su008.pre.tumor_AAGGCAGTCACCGTAA     1</span>
<span class="co">#&gt; 10 CDK11A   chr1  1702379 1724357 bcc.su008.pre.tumor_AAGGCAGTCACCGTAA     1</span>
<span class="co">#&gt; # … with 201,449 more rows</span>

<span class="co"># Remove default </span>
<span class="va">example_input</span><span class="op">$</span><span class="va">rna</span> <span class="op">%&gt;%</span> <span class="fu"><a href="../reference/filter_known_genes.html">filter_known_genes</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ── Ribosomal</span>
<span class="co">#&gt; ℹ n = 166 genes found.</span>
<span class="co">#&gt; MRPL20, RPL22, RPL11, MRPS15, RPS8, RPL5 , ...</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ── Mitochondrial</span>
<span class="co">#&gt; ℹ 180 genes found.</span>
<span class="co">#&gt; ICMT, CAMTA1, MTF2, HENMT1, LAMTOR5, MTMR11 , ...</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ── Specials</span>
<span class="co">#&gt; ℹ n = 1 genes found.</span>
<span class="co">#&gt; # A tibble: 190,566 x 6</span>
<span class="co">#&gt;    gene     chr      from      to cell                                 value</span>
<span class="co">#&gt;    &lt;chr&gt;    &lt;chr&gt;   &lt;int&gt;   &lt;int&gt; &lt;chr&gt;                                &lt;int&gt;</span>
<span class="co">#&gt;  1 NOC2L    chr1   944203  959309 bcc.su008.pre.tumor_AAGGCAGTCACCGTAA     2</span>
<span class="co">#&gt;  2 AGRN     chr1  1020120 1056118 bcc.su008.pre.tumor_AAGGCAGTCACCGTAA     1</span>
<span class="co">#&gt;  3 SDF4     chr1  1216909 1232067 bcc.su008.pre.tumor_AAGGCAGTCACCGTAA     1</span>
<span class="co">#&gt;  4 ACAP3    chr1  1292390 1309609 bcc.su008.pre.tumor_AAGGCAGTCACCGTAA     2</span>
<span class="co">#&gt;  5 CPTP     chr1  1324756 1328896 bcc.su008.pre.tumor_AAGGCAGTCACCGTAA     1</span>
<span class="co">#&gt;  6 AURKAIP1 chr1  1373730 1375495 bcc.su008.pre.tumor_AAGGCAGTCACCGTAA     1</span>
<span class="co">#&gt;  7 CCNL2    chr1  1385711 1399335 bcc.su008.pre.tumor_AAGGCAGTCACCGTAA     2</span>
<span class="co">#&gt;  8 CDK11B   chr1  1635225 1659012 bcc.su008.pre.tumor_AAGGCAGTCACCGTAA     1</span>
<span class="co">#&gt;  9 CDK11A   chr1  1702379 1724357 bcc.su008.pre.tumor_AAGGCAGTCACCGTAA     1</span>
<span class="co">#&gt; 10 WRAP73   chr1  3630767 3652761 bcc.su008.pre.tumor_AAGGCAGTCACCGTAA     2</span>
<span class="co">#&gt; # … with 190,556 more rows</span>

<span class="co"># Remove only ribosomal </span>
<span class="va">example_input</span><span class="op">$</span><span class="va">rna</span> <span class="op">%&gt;%</span>  <span class="fu"><a href="../reference/filter_known_genes.html">filter_known_genes</a></span><span class="op">(</span>what <span class="op">=</span> <span class="st">'r'</span>, specials <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ── Ribosomal</span>
<span class="co">#&gt; ℹ n = 166 genes found.</span>
<span class="co">#&gt; MRPL20, RPL22, RPL11, MRPS15, RPS8, RPL5 , ...</span>
<span class="co">#&gt; # A tibble: 194,236 x 6</span>
<span class="co">#&gt;    gene     chr      from      to cell                                 value</span>
<span class="co">#&gt;    &lt;chr&gt;    &lt;chr&gt;   &lt;int&gt;   &lt;int&gt; &lt;chr&gt;                                &lt;int&gt;</span>
<span class="co">#&gt;  1 NOC2L    chr1   944203  959309 bcc.su008.pre.tumor_AAGGCAGTCACCGTAA     2</span>
<span class="co">#&gt;  2 AGRN     chr1  1020120 1056118 bcc.su008.pre.tumor_AAGGCAGTCACCGTAA     1</span>
<span class="co">#&gt;  3 SDF4     chr1  1216909 1232067 bcc.su008.pre.tumor_AAGGCAGTCACCGTAA     1</span>
<span class="co">#&gt;  4 ACAP3    chr1  1292390 1309609 bcc.su008.pre.tumor_AAGGCAGTCACCGTAA     2</span>
<span class="co">#&gt;  5 CPTP     chr1  1324756 1328896 bcc.su008.pre.tumor_AAGGCAGTCACCGTAA     1</span>
<span class="co">#&gt;  6 AURKAIP1 chr1  1373730 1375495 bcc.su008.pre.tumor_AAGGCAGTCACCGTAA     1</span>
<span class="co">#&gt;  7 CCNL2    chr1  1385711 1399335 bcc.su008.pre.tumor_AAGGCAGTCACCGTAA     2</span>
<span class="co">#&gt;  8 CDK11B   chr1  1635225 1659012 bcc.su008.pre.tumor_AAGGCAGTCACCGTAA     1</span>
<span class="co">#&gt;  9 CDK11A   chr1  1702379 1724357 bcc.su008.pre.tumor_AAGGCAGTCACCGTAA     1</span>
<span class="co">#&gt; 10 WRAP73   chr1  3630767 3652761 bcc.su008.pre.tumor_AAGGCAGTCACCGTAA     2</span>
<span class="co">#&gt; # … with 194,226 more rows</span></code></pre></div>
</div>
<div id="outliers" class="section level3">
<h3 class="hasAnchor">
<a href="#outliers" class="anchor"></a>Outliers</h3>
<blockquote>
<p>TODO</p>
</blockquote>
</div>
</div>
<div id="filtering-mapped-data" class="section level2">
<h2 class="hasAnchor">
<a href="#filtering-mapped-data" class="anchor"></a>Filtering mapped data</h2>
<div id="outliers-per-segments" class="section level3">
<h3 class="hasAnchor">
<a href="#outliers-per-segments" class="anchor"></a>Outliers per segments</h3>
<p>After mapping counts data to segments, a function can be used to determine quantiles of mapped data, for every cell, and identify outliers in each segment and modality.</p>
<p>Outliers are identified by using a quantile range <span class="math inline">\(q = (q_l, q_r)\)</span> with <span class="math inline">\(q_r,q_l\in [0,1]\)</span> reporting lower and upper quantiles. The quantiles are computed and applied per segment.</p>
<p>For every cell we count how often that is an oulier - i.e., in how many of the input segments - and remove it if this frequency si above a certain cutoff.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># A couple segments from the object</span>
<span class="va">segment_id</span> <span class="op">=</span> <span class="va">example_object</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/get_input.html">get_input</a></span><span class="op">(</span><span class="st">'segmentation'</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/ranking.html">row_number</a></span><span class="op">(</span><span class="op">)</span> <span class="op">&lt;=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">segment_id</span><span class="op">)</span>

<span class="co"># Original segment plot</span>
<span class="fu"><a href="../reference/plot_data.html">plot_data</a></span><span class="op">(</span><span class="va">example_object</span>, what <span class="op">=</span> <span class="st">'histogram'</span>, segments <span class="op">=</span> <span class="va">segment_id</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="va">print</span>
<span class="co">#&gt; → Normalising ATAC counts using input normalisation factors.</span></code></pre></div>
<p><img src="Filtering_files/figure-html/unnamed-chunk-5-1.png" width="768"></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co"># Filter with 5%/95% values</span>
<span class="va">example_object</span> <span class="op">=</span> <span class="va">example_object</span> <span class="op">%&gt;%</span> <span class="fu"><a href="../reference/filter_outliers.html">filter_outliers</a></span><span class="op">(</span>lower_quantile <span class="op">=</span> <span class="fl">.05</span>, <span class="fl">.95</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ── RNA outliers detection via quantiles: lower 0.05, upper 0.97.</span>
<span class="co">#&gt; → 1958 out of 4548 will be removed (43%)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ── ATAC outliers detection via quantiles: lower 0.05, upper 0.97.</span>
<span class="co">#&gt; → Normalising ATAC counts using input normalisation factors.</span>
<span class="co">#&gt; → 3848 out of 4999 will be removed (77%)</span>

<span class="co"># Show the difference</span>
<span class="fu"><a href="../reference/plot_data.html">plot_data</a></span><span class="op">(</span><span class="va">example_object</span>, what <span class="op">=</span> <span class="st">'histogram'</span>, segments <span class="op">=</span> <span class="va">segment_id</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="va">print</span>
<span class="co">#&gt; → Normalising ATAC counts using input normalisation factors.</span></code></pre></div>
<p><img src="Filtering_files/figure-html/unnamed-chunk-5-2.png" width="768"></p>
<!-- > If you used \code{action = 'remove'} The returned object will contain fewer entries; it should be checked for an excess of zeros after filtering. We show an example below -->
<!-- Compare 0-count cells before and after the filter -->
<!-- ```{r} -->
<!-- # RNA 0-counts difference -->
<!-- stat(example_object)$zero_counts_cells_RNA %>% print -->
<!-- stat(f_example_object)$zero_counts_cells_RNA %>% print  # capped -->
<!-- stat(f2_example_object)$zero_counts_cells_RNA %>% print # removed -->
<!-- ``` -->
<!-- ```{r} -->
<!-- # ATAC 0-counts difference -->
<!-- stat(example_object)$zero_counts_cells_ATAC %>% print -->
<!-- stat(f_example_object)$zero_counts_cells_ATAC %>% print  # capped -->
<!-- stat(f2_example_object)$zero_counts_cells_ATAC %>% print # removed -->
<!-- ``` -->
<!-- The extent of the new 0-counts cells can be summarised printing the filtered object to console. -->
<!-- ```{r} -->
<!-- f_example_object %>% print -->
<!-- f2_example_object %>% print -->
<!-- ``` -->
</div>
<div id="cells-with-missing-data" class="section level3">
<h3 class="hasAnchor">
<a href="#cells-with-missing-data" class="anchor"></a>Cells with missing data</h3>
<p>Some cells can have have 0-counts because they have no events mapping to a certain segment, or because some heavy filtering inflated the number of 0-count cells. These generally count as <em>missing data</em></p>
<blockquote>
<p>Missing data will be imputed to have value 0 before fit, and excessive 0s will force the model use mixture components peaked at 0. We suggest therefore to remove these entries or at least try to keep their number to a minimum.</p>
</blockquote>
<p>A filter is available to remove cells with missing data above a proportion <span class="math inline">\(p\in[0,1]\)</span> of the number of input segments (e.g., all cells with &gt;20% of segments with missing data).</p>
<p>The presence of missing data is reported by a print to console of an object.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">example_object</span> <span class="op">%&gt;%</span> <span class="va">print</span>
<span class="co">#&gt; x Warning ATAC 0-counts cells. 17 cells have no data in any of 36 segments, top 5 with missing data are:</span>
<span class="co">#&gt; x Cell ACCATCCAGTCGTATC-CRC_17 with 1 0-segments (3%)</span>
<span class="co">#&gt; x Cell ACTGTCCTCGGATAAA-CRC_17 with 1 0-segments (3%)</span>
<span class="co">#&gt; x Cell ACTTTCACACTTGCGG-CRC_17 with 1 0-segments (3%)</span>
<span class="co">#&gt; x Cell ATAGGCTAGGTCGGTA-CRC_17 with 1 0-segments (3%)</span>
<span class="co">#&gt; x Cell CACCTGTAGCAAGGTC-CRC_17 with 1 0-segments (3%)</span>
<span class="co">#&gt; ── [ (R)CONGAS+ ] Example object for (R)CONGAS+ ────────────────────────────────</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ── CNA segments (reference: GRCh38)</span>
<span class="co">#&gt; → Input 36 CNA segments, mean ploidy 3.67.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     |  | | | | |  |  | | | | | | |  |  |   | |    | |  |  </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;   Ploidy:    0     1     2     3     4     5     *</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ── Modalities</span>
<span class="co">#&gt; → RNA: 2590 cells with 16005 mapped genes, 16748279 non-zero values. Likelihood: Gaussian.</span>
<span class="co">#&gt; → ATAC: 1151 cells with 210 mapped peaks, 1040663 non-zero values. Likelihood: Negative Binomial.</span>
<span class="co">#&gt; ! Clusters: not available.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ──  LOG  ──</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; - 2021-04-01 12:37:12 Filtered outliers: [0.95|0.05|0.97]</span>
<span class="co">#&gt; [1] 0</span></code></pre></div>
<p>Now we apply the filter (e.g., <code>proportion_RNA = 0</code> means that cells with &gt;0 missing data are removed).</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">example_object</span> <span class="op">=</span> <span class="va">example_object</span> <span class="op">%&gt;%</span> <span class="fu"><a href="../reference/filter_missing_data.html">filter_missing_data</a></span><span class="op">(</span>proportion_RNA <span class="op">=</span> <span class="fl">0</span>, proportion_ATAC <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>
<span class="co">#&gt; x Warning ATAC 0-counts cells. 17 cells have no data in any of 36 segments, top 5 with missing data are:</span>
<span class="co">#&gt; x Cell ACCATCCAGTCGTATC-CRC_17 with 1 0-segments (3%)</span>
<span class="co">#&gt; x Cell ACTGTCCTCGGATAAA-CRC_17 with 1 0-segments (3%)</span>
<span class="co">#&gt; x Cell ACTTTCACACTTGCGG-CRC_17 with 1 0-segments (3%)</span>
<span class="co">#&gt; x Cell ATAGGCTAGGTCGGTA-CRC_17 with 1 0-segments (3%)</span>
<span class="co">#&gt; x Cell CACCTGTAGCAAGGTC-CRC_17 with 1 0-segments (3%)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ── ATAC modality, proportions cut 0</span>
<span class="co">#&gt; → Cells with missing data 17, removing 17</span></code></pre></div>
<p>Now the object has fewer cells.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">example_object</span> <span class="op">%&gt;%</span> <span class="va">print</span>
<span class="co">#&gt; ── [ (R)CONGAS+ ] Example object for (R)CONGAS+ ────────────────────────────────</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ── CNA segments (reference: GRCh38)</span>
<span class="co">#&gt; → Input 36 CNA segments, mean ploidy 3.67.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     |  | | | | |  |  | | | | | | |  |  |   | |    | |  |  </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;   Ploidy:    0     1     2     3     4     5     *</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ── Modalities</span>
<span class="co">#&gt; → RNA: 2590 cells with 16005 mapped genes, 16748279 non-zero values. Likelihood: Gaussian.</span>
<span class="co">#&gt; → ATAC: 1134 cells with 210 mapped peaks, 1040663 non-zero values. Likelihood: Negative Binomial.</span>
<span class="co">#&gt; ! Clusters: not available.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ──  LOG  ──</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; - 2021-04-01 12:37:12 Filtered outliers: [0.95|0.05|0.97]</span>
<span class="co">#&gt; - 2021-04-01 12:37:15 Filtered missing data: [0|0]</span>
<span class="co">#&gt; [1] 0</span></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://www.caravagnalab.org">Salvatore Milite</a>, <a href="https://www.caravagnalab.org">Riccardo Bergamin</a>, <a href="https://www.caravagnalab.org">Giulio Caravagna</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
